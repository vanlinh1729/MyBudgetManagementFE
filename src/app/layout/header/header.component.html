<header class="sticky top-0 z-40 w-full bg-white/95 backdrop-blur-md border-b border-gray-200/60">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex h-16 items-center justify-between">
      <!-- Logo Section -->
      <div class="flex items-center gap-3">
        <div class="flex items-center gap-3">
          <div class="w-9 h-9 bg-slate-900 rounded-lg flex items-center justify-center">
            <i-lucide name="wallet" class="w-5 h-5 text-white"></i-lucide>
          </div>
          <div>
            <h1 class="text-lg font-semibold text-gray-900 hidden sm:block">
              Budget Management
            </h1>
            <h1 class="text-lg font-semibold text-gray-900 sm:hidden">MBM</h1>
          </div>
        </div>
      </div>
      
      <!-- Mobile Menu Button -->
      <button 
        class="md:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors" 
        (click)="toggleMobileMenu()"
        aria-label="Toggle menu"
      >
        <i-lucide name="menu" class="w-5 h-5 text-gray-700"></i-lucide>
      </button>

      <!-- Desktop Actions -->
      <div class="hidden md:flex items-center gap-4">
        <!-- Search -->
        <div class="relative search-container">
          <div class="relative">
            <div class="absolute inset-y-0 left-0 flex items-center pl-3">
              <i-lucide name="search" class="w-4 h-4 text-gray-400"></i-lucide>
            </div>
            <input
              [(ngModel)]="searchQuery"
              (focus)="showQuickNav = true"
              (blur)="onSearchBlur()"
              placeholder="Tìm kiếm hoặc điều hướng nhanh..."
              class="search-input w-80 pl-10 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-transparent bg-gray-50 hover:bg-white transition-all"
            />
            <button 
              *ngIf="searchQuery"
              (click)="clearSearch()"
              class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600"
            >
              <i-lucide name="x" class="w-4 h-4"></i-lucide>
            </button>
          </div>
          
          <!-- Quick Navigation Menu -->
          <div *ngIf="showQuickNav" class="quick-nav-dropdown absolute top-full left-0 right-0 mt-2 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50">
            <div class="px-4 py-2 border-b border-gray-100">
              <h3 class="text-sm font-semibold text-gray-900">Điều hướng nhanh</h3>
            </div>
            
            <!-- Main Section -->
            <div class="py-2">
              <div class="px-4 py-1">
                <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Tổng quan</p>
              </div>
              <button 
                (click)="navigateToPage('/dashboard')"
                class="w-full px-4 py-2 text-left hover:bg-gray-50 transition-colors flex items-center gap-3"
              >
                <div class="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center">
                  <i-lucide name="layout-dashboard" class="w-4 h-4 text-blue-600"></i-lucide>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-900">Dashboard</p>
                  <p class="text-xs text-gray-500">Tổng quan tài chính</p>
                </div>
              </button>
            </div>
            
            <!-- Finance Section -->
            <div class="py-2">
              <div class="px-4 py-1">
                <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Tài chính</p>
              </div>
              <button 
                (click)="navigateToPage('/transactions')"
                class="w-full px-4 py-2 text-left hover:bg-gray-50 transition-colors flex items-center gap-3"
              >
                <div class="w-8 h-8 rounded-lg bg-green-100 flex items-center justify-center">
                  <i-lucide name="receipt" class="w-4 h-4 text-green-600"></i-lucide>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-900">Giao dịch</p>
                  <p class="text-xs text-gray-500">Quản lý thu chi</p>
                </div>
              </button>
              
              <button 
                (click)="navigateToPage('/categories')"
                class="w-full px-4 py-2 text-left hover:bg-gray-50 transition-colors flex items-center gap-3"
              >
                <div class="w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center">
                  <i-lucide name="folder-open" class="w-4 h-4 text-purple-600"></i-lucide>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-900">Danh mục & Ngân sách</p>
                  <p class="text-xs text-gray-500">Phân loại và lập ngân sách</p>
                </div>
              </button>
              
              <button 
                (click)="navigateToPage('/debt')"
                class="w-full px-4 py-2 text-left hover:bg-gray-50 transition-colors flex items-center gap-3"
              >
                <div class="w-8 h-8 rounded-lg bg-orange-100 flex items-center justify-center">
                  <i-lucide name="credit-card" class="w-4 h-4 text-orange-600"></i-lucide>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-900">Nợ & Cho vay</p>
                  <p class="text-xs text-gray-500">Quản lý công nợ</p>
                </div>
              </button>
            </div>
            
            <!-- Others Section -->
            <div class="py-2">
              <div class="px-4 py-1">
                <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Khác</p>
              </div>
              <button 
                (click)="navigateToPage('/reports')"
                class="w-full px-4 py-2 text-left hover:bg-gray-50 transition-colors flex items-center gap-3"
              >
                <div class="w-8 h-8 rounded-lg bg-indigo-100 flex items-center justify-center">
                  <i-lucide name="chart-line" class="w-4 h-4 text-indigo-600"></i-lucide>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-900">Báo cáo</p>
                  <p class="text-xs text-gray-500">Phân tích chi tiết</p>
                </div>
              </button>
              
              <button 
                (click)="navigateToPage('/profile')"
                class="w-full px-4 py-2 text-left hover:bg-gray-50 transition-colors flex items-center gap-3"
              >
                <div class="w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center">
                  <i-lucide name="user" class="w-4 h-4 text-gray-600"></i-lucide>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-900">Hồ sơ cá nhân</p>
                  <p class="text-xs text-gray-500">Thông tin tài khoản</p>
                </div>
              </button>
            </div>
          </div>
        </div>
        
        <!-- Quick Add -->
        <button class="p-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 transition-colors">
          <i-lucide name="plus" class="w-4 h-4"></i-lucide>
        </button>
        
        <!-- Notifications -->
        <div class="relative notification-container">
          <button
            (click)="toggleNotifications()"
            class="relative p-2 rounded-lg hover:bg-gray-100 transition-colors"
          >
            <i-lucide name="bell" class="w-4 h-4 text-gray-700"></i-lucide>
            <span class="notification-badge absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-xs font-medium text-white">
              3
            </span>
          </button>
          
          <!-- Notifications Dropdown -->
          <div *ngIf="showNotifications" class="notification-dropdown absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50">
            <div class="px-4 py-3 border-b border-gray-100">
              <h3 class="text-sm font-semibold text-gray-900">Thông báo</h3>
            </div>
            <div class="py-1">
              <div class="px-4 py-3 hover:bg-gray-50 transition-colors">
                <div class="flex items-start gap-3">
                  <div class="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center">
                    <i-lucide name="trending-up" class="w-4 h-4 text-blue-600"></i-lucide>
                  </div>
                  <div class="flex-1">
                    <p class="text-sm font-medium text-gray-900">Giao dịch mới</p>
                    <p class="text-xs text-gray-500">Bạn có giao dịch chi tiêu mới: 50,000 VNĐ</p>
                    <p class="text-xs text-gray-400 mt-1">2 phút trước</p>
                  </div>
                </div>
              </div>
              <div class="px-4 py-3 text-center">
                <button class="text-sm text-slate-600 hover:text-slate-900 font-medium">
                  Xem tất cả
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- User Menu -->
        <div class="relative user-menu-container">
          <button
            (click)="toggleUserMenu()"
            class="flex items-center gap-2 p-1 rounded-lg hover:bg-gray-100 transition-colors"
          >
            <img
              [src]="getUserAvatarUrl()"
              [alt]="getUserDisplayName()"
              class="w-8 h-8 rounded-lg object-cover"
            />
            <div class="hidden lg:block text-left">
              <p class="text-sm font-medium text-gray-900">{{getUserDisplayName()}}</p>
              <p class="text-xs text-gray-500">{{getUserEmail()}}</p>
            </div>
            <i-lucide name="chevron-down" class="w-4 h-4 text-gray-400"></i-lucide>
          </button>
          
          <!-- User Dropdown -->
          <div *ngIf="showUserMenu" class="user-dropdown absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50">
            <div class="px-4 py-3 border-b border-gray-100">
              <div class="flex items-center gap-3">
                <img
                  [src]="getUserAvatarUrl()"
                  [alt]="getUserDisplayName()"
                  class="w-10 h-10 rounded-lg object-cover"
                />
                <div>
                  <p class="text-sm font-semibold text-gray-900">{{getUserDisplayName()}}</p>
                  <p class="text-xs text-gray-500">{{getUserEmail()}}</p>
                </div>
              </div>
            </div>
            
            <div class="py-1">
              <button 
                (click)="navigateToProfile()"
                class="w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-3"
              >
                <i-lucide name="user" class="w-4 h-4"></i-lucide>
                <span>Hồ sơ cá nhân</span>
              </button>
              
              <button 
                (click)="navigateToSettings()"
                class="w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-3"
              >
                <i-lucide name="settings" class="w-4 h-4"></i-lucide>
                <span>Cài đặt</span>
              </button>
              
              <button 
                class="w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-3"
              >
                <i-lucide name="help-circle" class="w-4 h-4"></i-lucide>
                <span>Trợ giúp</span>
              </button>
            </div>
            
            <div class="border-t border-gray-100 pt-1">
              <button 
                (click)="logout()"
                class="w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 transition-colors flex items-center gap-3"
              >
                <i-lucide name="log-out" class="w-4 h-4"></i-lucide>
                <span>Đăng xuất</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>
